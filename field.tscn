[gd_scene load_steps=21 format=3 uid="uid://b1psoaww4dkmv"]

[ext_resource type="Script" path="res://field.gd" id="1_a1q4k"]
[ext_resource type="PackedScene" uid="uid://cw8w6clmxedi6" path="res://player.tscn" id="2_yh3il"]
[ext_resource type="Shader" path="res://board.gdshader" id="3_6dudo"]
[ext_resource type="Texture2D" uid="uid://bd0ewd5v5stm8" path="res://levels/level1.png" id="5_1rdm2"]
[ext_resource type="Script" path="res://states/state_machine.gd" id="5_8eoi3"]
[ext_resource type="Script" path="res://states/field_start.gd" id="6_gd6xd"]
[ext_resource type="Script" path="res://states/field_game.gd" id="7_ioieq"]
[ext_resource type="Script" path="res://states/field_gameover.gd" id="8_mswy3"]

[sub_resource type="FastNoiseLite" id="FastNoiseLite_lsepe"]

[sub_resource type="NoiseTexture2D" id="NoiseTexture2D_c1buu"]
noise = SubResource("FastNoiseLite_lsepe")

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_n53v7"]
albedo_color = Color(0, 0, 0, 1)
roughness = 0.0
rim = 0.0
rim_tint = 0.0
heightmap_scale = -2.385
heightmap_texture = SubResource("NoiseTexture2D_c1buu")

[sub_resource type="QuadMesh" id="QuadMesh_3h23r"]
material = SubResource("StandardMaterial3D_n53v7")
size = Vector2(40, 40)

[sub_resource type="Animation" id="Animation_sthlb"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:transparency")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}

[sub_resource type="Animation" id="Animation_vggfv"]
resource_name = "fade"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:transparency")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.4, 1),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [0.0, 0.0, 1.0]
}

[sub_resource type="Animation" id="Animation_5uwg7"]
resource_name = "show"
length = 0.7
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath(".:transparency")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.3, 0.7),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [1.0, 1.0, 0.0]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_w8csh"]
_data = {
"RESET": SubResource("Animation_sthlb"),
"fade": SubResource("Animation_vggfv"),
"show": SubResource("Animation_5uwg7")
}

[sub_resource type="ShaderMaterial" id="ShaderMaterial_x2atr"]
render_priority = 0
shader = ExtResource("3_6dudo")
shader_parameter/noise = ExtResource("5_1rdm2")

[sub_resource type="QuadMesh" id="QuadMesh_ylyq7"]
material = SubResource("ShaderMaterial_x2atr")
size = Vector2(40, 40)

[sub_resource type="BoxMesh" id="BoxMesh_ir1tk"]
size = Vector3(42, 1, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_apf7b"]
size = Vector3(41.5, 1, 1)

[node name="World" type="Node3D"]
script = ExtResource("1_a1q4k")
player_scene = ExtResource("2_yh3il")
slate_colors = Array[Color]([Color(0.596078, 0, 0, 1), Color(0, 0.721569, 0, 1), Color(0, 0, 0.980392, 1)])
noise_texture = ExtResource("5_1rdm2")
metadata/dimension = Vector2(0, 0)

[node name="Players" type="Node3D" parent="."]

[node name="Camera" type="Camera3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 12.5537)
projection = 1
size = 20.0

[node name="screen" type="MeshInstance3D" parent="Camera"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -9.3266)
cast_shadow = 0
gi_mode = 0
mesh = SubResource("QuadMesh_3h23r")
skeleton = NodePath("../..")

[node name="AnimationPlayer" type="AnimationPlayer" parent="Camera/screen"]
libraries = {
"": SubResource("AnimationLibrary_w8csh")
}

[node name="PlayersSpawner" type="MultiplayerSpawner" parent="."]
_spawnable_scenes = PackedStringArray("res://player.tscn")
spawn_path = NodePath("../Players")

[node name="OmniLight3D" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 5.93829)
light_energy = 4.0
omni_range = 23.175

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.840985, -0.539857, 0.0360349, -0.344182, 0.585175, 0.73424, -0.417471, 0.605083, -0.677933, 0.957167, 0, 8.06103)
light_energy = 2.0
light_indirect_energy = 3.262
shadow_enabled = true
sky_mode = 1

[node name="board" type="MeshInstance3D" parent="."]
mesh = SubResource("QuadMesh_ylyq7")

[node name="Top" type="StaticBody3D" parent="board"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.08165e-12, 20.5, 0.523)

[node name="MeshInstance3D" type="MeshInstance3D" parent="board/Top"]
mesh = SubResource("BoxMesh_ir1tk")

[node name="CollisionShape3D" type="CollisionShape3D" parent="board/Top"]
shape = SubResource("BoxShape3D_apf7b")

[node name="Bottom" type="StaticBody3D" parent="board"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.08165e-12, -20.5, 0.523)

[node name="MeshInstance3D" type="MeshInstance3D" parent="board/Bottom"]
mesh = SubResource("BoxMesh_ir1tk")

[node name="CollisionShape3D" type="CollisionShape3D" parent="board/Bottom"]
shape = SubResource("BoxShape3D_apf7b")

[node name="Left" type="StaticBody3D" parent="board"]
transform = Transform3D(-4.37114e-08, -1, 3.48787e-16, 1, -4.37114e-08, -3.48787e-16, 3.48787e-16, 3.48787e-16, 1, -20.5, 2.08165e-12, 0.523)

[node name="MeshInstance3D" type="MeshInstance3D" parent="board/Left"]
transform = Transform3D(1, 1.21652e-31, 0, 1.21652e-31, 1, 0, 0, 0, 1, 0, 0, 0)
mesh = SubResource("BoxMesh_ir1tk")

[node name="CollisionShape3D" type="CollisionShape3D" parent="board/Left"]
shape = SubResource("BoxShape3D_apf7b")

[node name="Right" type="StaticBody3D" parent="board"]
transform = Transform3D(-4.37114e-08, -1, 3.48787e-16, 1, -4.37114e-08, -3.48787e-16, 3.48787e-16, 3.48787e-16, 1, 20.5, 2.08165e-12, 0.523)

[node name="MeshInstance3D" type="MeshInstance3D" parent="board/Right"]
mesh = SubResource("BoxMesh_ir1tk")

[node name="CollisionShape3D" type="CollisionShape3D" parent="board/Right"]
shape = SubResource("BoxShape3D_apf7b")

[node name="ObjectsSpawner" type="MultiplayerSpawner" parent="."]
_spawnable_scenes = PackedStringArray("res://food.tscn", "res://slate.tscn")
spawn_path = NodePath("../Objects")

[node name="Objects" type="Node3D" parent="."]

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("5_8eoi3")
initial_state = NodePath("FieldStart")

[node name="FieldStart" type="Node" parent="StateMachine" node_paths=PackedStringArray("field")]
script = ExtResource("6_gd6xd")
field = NodePath("../..")

[node name="FieldGame" type="Node" parent="StateMachine" node_paths=PackedStringArray("field")]
script = ExtResource("7_ioieq")
field = NodePath("../..")

[node name="FieldGameover" type="Node" parent="StateMachine" node_paths=PackedStringArray("field")]
script = ExtResource("8_mswy3")
field = NodePath("../..")

[connection signal="animation_finished" from="Camera/screen/AnimationPlayer" to="." method="_on_animation_player_animation_finished"]
[connection signal="spawned" from="PlayersSpawner" to="." method="_on_players_spawner_spawned"]
